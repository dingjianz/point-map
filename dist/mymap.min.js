!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MyMap=e():t.MyMap=e()}(window,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t){t.exports=JSON.parse("[[[7,2]],[7],[[7,2]],[8],[],[],[[8,3]],[[6,5],12,65],[[6,5]],[[6,6],65],[[6,6],26,65],[[6,6],65,67],[[6,5],65,67],[[6,5],[65,3]],[[6,4],[64,4]],[[6,5],[64,4]],[[6,5],[64,4]],[[7,4],[64,4]],[[7,4],[64,4]],[[7,5],[64,4]],[[6,7],[64,4]],[[6,9],[64,4]],[[5,10],[64,4]],[[5,15],[64,4]],[3,5,[7,14],[64,4]],[[3,3],[7,14],[64,4]],[[4,19],[64,4]],[[3,21],[64,4]],[[3,21],[64,4]],[[4,21],[64,4]],[[5,22],[64,4]],[[5,22],[63,5]],[[4,2],[7,21],[63,5]],[[4,24],[64,4]],[[2,21],27,[64,4]],[2,[4,6],[11,12],[27,2],[63,5]],[[0,3],[4,2],[7,2],[11,12],[26,3],[63,5]],[[0,9],[12,10],26,28,[63,5]],[[0,9],[12,11],[28,3],[64,4]],[[0,10],[12,12],25,30,[64,4]],[[0,7],9,[14,8],[23,3],31,[34,3],[63,5]],[[0,3],[5,2],[8,3],[12,9],[24,3],[31,8],[64,4]],[[0,3],[5,14],26,[30,11],[53,2],[64,4]],[[0,3],[6,12],26,[30,11],[48,8],64,[66,2]],[[0,4],[6,11],26,[29,28],[62,3],67],[[0,4],[6,4],[11,6],[30,24],56,[61,4],67],[[0,4],[7,10],[30,22],56,[62,3],[66,2]],[[0,4],[11,4],16,[30,21],60,[62,2],[66,2]],[[0,4],[12,3],[31,19],[66,2]],[[0,5],[12,4],[32,18],67],[[0,6],15,[32,17],67],[[2,7],15,[32,16],[66,2]],[[0,10],[34,13],[66,2]],[[0,10],[35,10],[65,3]],[[0,11],[35,9],[65,3]],[[0,10],[35,9],67],[[0,9],[35,8],67],[[0,8],[36,3],67],[[0,8],[36,2],65,67],[[0,8],[65,3]],[[0,7],[65,3]],[[0,7],[65,3]],[[0,7],[65,3]],[[0,7],8,[65,3]],[[2,3],8,[64,4]],[2,8,28,[64,4]],[8,[24,6],[63,5]],[[23,9],[63,5]],[13,[22,10],[63,5]],[[12,2],[17,3],[21,12],[63,5]],[[11,4],[17,16],[63,5]],[[11,3],15,[17,16],[63,5]],[[13,6],[20,12],[63,5]],[[14,4],[20,12],[63,5]],[[9,2],[13,4],[20,13],[62,6]],[[9,2],[13,4],[19,14],[62,6]],[[9,8],[18,18],[62,6]],[2,[8,10],19,[21,16],[39,3],[62,6]],[[2,2],[7,5],[13,7],[21,24],[62,6]],[[2,2],[7,4],[12,6],[22,25],[62,6]],[2,[6,3],[12,7],[21,27],[62,6]],[[2,2],[6,2],[9,11],[21,27],[62,6]],[2,[6,12],20,[22,26],[62,6]],[[6,4],[11,9],[22,26],[62,6]],[[6,10],[18,2],[22,25],[62,6]],[[6,11],[18,3],[22,24],[62,6]],[[7,13],[21,2],[24,20],[62,6]],[[7,10],[18,7],[27,15],[62,6]],[[7,10],[18,9],[28,8],[38,3],[62,6]],[[8,27],[62,6]],[[7,22],[30,4],[41,4],[61,7]],[2,[8,8],[17,12],[30,3],[40,4],[61,7]],[[7,9],[18,5],[24,5],30,[39,2],[61,7]],[5,[7,12],[20,4],[25,3],[61,7]],[5,[7,21],[61,7]],[4,[7,17],[25,2],[61,7]],[4,[6,18],25,[61,7]],[[6,19],[61,7]],[[7,17],[61,7]],[[6,19],[61,7]],[[5,21],[63,5]],[[5,22],[63,5]],[[5,25],[62,6]],[[5,26],[62,6]],[[5,27],[61,7]],[[5,23],[61,7]],[[5,22],[61,7]],[[4,22],[61,7]],[[4,22],[61,7]],[2,[4,23],[61,7]],[2,[4,24],32,[61,7]],[2,[4,25],[32,2],[61,7]],[2,[4,26],[31,4],[61,7]],[[3,27],[32,4],[60,8]],[[3,28],[35,2],[61,7]],[[4,22],[28,2],37,[61,7]],[[4,23],[34,2],37,[61,7]],[[4,22],[33,3],37,[61,7]],[[5,21],[32,4],37,[43,5],[61,7]],[[5,20],[32,3],[42,7],[61,7]],[[5,13],19,[21,3],25,[27,2],[34,3],38,[42,6],[61,7]],[[5,15],27,[30,2],[36,2],[41,7],[61,7]],[[5,15],[29,3],[40,8],[61,7]],[[5,16],[33,3],[40,7],[61,7]],[[6,12],21,35,[39,8],[61,7]],[[6,12],20,[34,2],[39,8],[61,7]],[[6,11],20,[39,9],[60,8]],[4,[6,6],[13,3],[19,2],[35,3],[41,8],[61,7]],[[4,7],[13,2],[17,4],[35,3],[41,9],[61,7]],[[4,7],[13,5],[36,2],[39,11],[61,7]],[[5,6],[36,2],[40,10],51,[61,7]],[[4,7],[37,2],[42,8],51,[61,7]],[4,[6,5],36,38,[43,6],[62,6]],[[6,5],[44,3],[62,6]],[[6,4],12,36,[62,6]],[[6,4],[11,3],[62,6]],[[7,6],38,[62,6]],[[6,6],[62,4],67],[[7,4],63,65,67],[[7,4],52,63,67],[[6,5],[51,2],63],[[6,4],48,[50,2]],[[6,4],[49,2]],[[7,3],41,49]]")},function(t,e,s){"use strict";s.r(e);var i=s(0);s.d(e,"MyMap",function(){return a});class a{constructor(t,e){this.globalRawData=function(t){let e=[];return t.forEach((t,s)=>{e[s]=e[s]||[],t.forEach(t=>{if("number"==typeof t)e[s].push(t);else for(let i=0;i<t[1];i++)e[s].push(t[0]+i)})}),e}(i),this.coordinate={bbox:[-180,-85,180,85],grid:2.5},this.dom=document.getElementById(t),this.config=Object.assign({mapBgColor:"#87bce1",mapActiveBgColor:"#87BCE1",eventPointColor:"#fefefe",activePointColor:"#3bc705"},e||{}),this.initCanvas(),this.initEvents(),this.animation()}animation(){requestAnimationFrame(()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),["drawBasicMap","drawEventPointWave"].forEach(t=>{const e=this[t]();e&&this.ctx.drawImage(e,0,0,e.width/this.screenRatio,e.height/this.screenRatio)}),this.needRedraw=!1,this.animation()})}initCanvas(){const t=(Math.abs(this.coordinate.bbox[1])+Math.abs(this.coordinate.bbox[3]))/(Math.abs(this.coordinate.bbox[0])+Math.abs(this.coordinate.bbox[2]));this.canvasWidth=Math.min(parseInt(getComputedStyle(this.dom).width),1200),this.scale=this.canvasWidth/((Math.abs(this.coordinate.bbox[0])+Math.abs(this.coordinate.bbox[2]))/this.coordinate.grid),this.dom.style.textAlign="center",this.screenRatio=window.devicePixelRatio,this.needRedraw=!0,["canvas","canvas-map","canvas-wave"].forEach(e=>{const s=this[e]=document.createElement("canvas");s.style.width=`${this.canvasWidth}px`,s.style.height=`${this.canvasWidth*t}px`,s.width=`${this.canvasWidth*this.screenRatio}`,s.height=`${this.canvasWidth*t*this.screenRatio}`,(this[`ctx-${e}`]=s.getContext("2d")).scale(this.screenRatio,this.screenRatio)}),this.canvas.style.margin="0 auto",this.ctx=this.canvas.getContext("2d"),this.dom.appendChild(this.canvas)}initEvents(){this.canvas.addEventListener("mousemove",t=>{const e=Math.round(t.offsetX/this.scale),s=Math.round(t.offsetY/this.scale);this.activePoint=[e,s];const i=this.events&&this.events[e]&&this.events[e][s];this.canvas.style.cursor=i?"pointer":"default",(this.customerEvents&&this.customerEvents.mousemove||[]).forEach(e=>e(t,i)),this.needRedraw=!0}),this.canvas.addEventListener("click",t=>{const e=Math.round(t.offsetX/this.scale),s=Math.round(t.offsetY/this.scale);if(this.events&&this.events[e]&&this.events[e][s]){(this.customerEvents&&this.customerEvents.click||[]).forEach(i=>i(t,this.events[e][s]))}this.needRedraw=!0})}drawBasicMap(){const t=this["canvas-map"];if(this.needRedraw){const e=this["ctx-canvas-map"];e.clearRect(0,0,t.width,t.height),e.save(),e.fillStyle=this.config.mapBgColor;let s=null,i=.4*this.scale;this.globalRawData.forEach((t,a)=>{t.forEach(t=>{this.activePoint&&this.activePoint[0]===a&&this.activePoint[1]===t?s=[a,t]:e.fillRect(a*this.scale-i/2,t*this.scale-i/2,i,i)})}),e.fillStyle=this.config.mapActiveBgColor,i=.8*this.scale,s&&e.fillRect(s[0]*this.scale-i/2,s[1]*this.scale-i/2,i,i),e.restore(),this.drawEventPoint()}return t}drawEventPoint(){if(this.needRedraw){const t=this["ctx-canvas-map"],e=this.events||{};let s=null,i=this.scale/2;if(t.beginPath(),Object.keys(e).map(t=>Number(t)).forEach(a=>{Object.keys(e[a]).map(t=>Number(t)).forEach(e=>{if(this.activePoint&&this.activePoint[0]===a&&this.activePoint[1]===e)s=[a,e];else{const s=a*this.scale,n=e*this.scale;t.beginPath(),t.fillStyle=this.config.eventPointColor,t.moveTo(s,n),t.arc(s,n,i,0,2*Math.PI),t.fill()}})}),s){const e=s[0]*this.scale,a=s[1]*this.scale;t.beginPath(),t.fillStyle=this.config.activePointColor,t.moveTo(e,a),t.arc(e,a,1.382*i,0,2*Math.PI),t.fill()}}}drawEventPointWave(){this._waveRadius=this._waveRadius||0;const t=this["canvas-wave"],e=this["ctx-canvas-wave"];e.globalCompositeOperation="destination-out",e.fillStyle="rgba(0, 0, 0, .08)",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation="lighter",e.lineWidth=1;const s=this.events||{};return e.save(),e.beginPath(),e.globalAlpha=.1,Object.keys(s).forEach(t=>{Object.keys(s[t]).forEach(s=>{e.strokeStyle=this.config.eventPointColor;const i=t*this.scale,a=s*this.scale;e.moveTo(i+this._waveRadius,a),e.arc(i,a,this._waveRadius,0,2*Math.PI)})}),this._waveRadius+=.1,e.stroke(),e.restore(),this._waveRadius>15&&(this._waveRadius=0),t}addEvent(t){const e=Math.round((t.coordinate[0]+Math.abs(this.coordinate.bbox[0]))/this.coordinate.grid),s=Math.round(Math.abs(t.coordinate[1]-this.coordinate.bbox[3])/this.coordinate.grid);this.events=this.events||{},this.events[e]=this.events[e]||{},this.events[e][s]=this.events[e][s]||[],this.events[e][s].push(t),this.needRedraw=!0}addEvents(t){t.forEach(t=>{this.addEvent(t)})}on(t,e){this.customerEvents=this.customerEvents||{},this.customerEvents[t]=this.customerEvents[t]||[],this.customerEvents[t].push(e)}remove(t,e){this.customerEvents=this.customerEvents||{},this.customerEvents[t]=this.customerEvents[t]||[];const s=this.customerEvents[t].indexOf(e);-1!==s&&this.customerEvents[t].splice(s,1)}}}]).MyMap});